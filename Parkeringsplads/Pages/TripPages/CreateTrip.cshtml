@page
@model Parkeringsplads.Pages.TripPages.CreateTripModel
@{
    ViewData["Title"] = "Opret tur for Admin";
}

@if (!string.IsNullOrEmpty(Model.SuccessMessage))
{
    <div class="alert alert-success">@Model.SuccessMessage</div>
}
@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger">@Model.ErrorMessage</div>
}

<h2>Opret tur for Admin</h2>

<!-- Debug info -->
<p><strong>Valgt retning:</strong> @Model.Direction</p>

<!-- Retning -->
<div class="mb-4">
    <label class="form-label">Retning</label><br />
    <div class="form-check form-check-inline">
        <a href="?handler=Direction&direction=ToSchool&selectedCarId=@Model.SelectedCarId" class="btn btn-outline-primary @(Model.Direction == "ToSchool" ? "active" : "")">Til skole</a>
    </div>
    <div class="form-check form-check-inline">
        <a href="?handler=Direction&direction=FromSchool&selectedCarId=@Model.SelectedCarId" class="btn btn-outline-primary @(Model.Direction == "FromSchool" ? "active" : "")">Fra skole</a>
    </div>
</div>

<!-- Bilvalg -->
<form method="get" class="mb-4">
    <input type="hidden" name="handler" value="SelectCar" />
    <input type="hidden" name="direction" value="@Model.Direction" />
    <input type="hidden" name="selectedAddress" value="@Model.SelectedAddress" />
    <input type="hidden" name="customAddress" value="@Model.CustomAddress" />
    <input type="hidden" name="useCustomAddress" value="@Model.UseCustomAddress" />
    <label class="form-label">Vælg bil</label>
    <select name="selectedCarId" class="form-control" onchange="this.form.submit()">
        <option value="">Vælg en bil</option>
        @foreach (var car in Model.Cars)
        {
            <option value="@car.CarId" selected="@(Model.SelectedCarId == car.CarId)">
                @car.CarModel
            </option>
        }
    </select>
</form>

<div class="mb-4">
    <label class="form-label">Adresse</label>

    <select class="form-control" name="selectedAddress">
        <option value="">Vælg en adresse</option>
        <option value="Address 1">Address 1</option>
        <option value="Address 2">Address 2</option>
        <option value="Address 3">Address 3</option>
    </select>

    <div class="form-check mt-2">
        <input type="checkbox" class="form-check-input" id="useCustom" name="useCustom" />
        <label class="form-check-label" for="useCustom">Indtast selv adresse</label>
    </div>

    <div class="mt-2">
        <input class="form-control" type="text" name="customAddress" placeholder="Egen adresse" disabled />
    </div>
</div>

<!-- Formular til at oprette tur -->
<form method="post">
    <input type="hidden" asp-for="Direction" />
    <input type="hidden" asp-for="SelectedCarId" />
    <input type="hidden" asp-for="SelectedAddress" />
    <input type="hidden" asp-for="CustomAddress" />
    <input type="hidden" asp-for="UseCustomAddress" />

    <!-- Destination -->
    @if (!string.IsNullOrWhiteSpace(Model.Trip.FromDestination))
    {
        <div class="mb-3">
            <label>Fra</label>
            <input type="text" class="form-control" value="@Model.Trip.FromDestination" readonly />
        </div>
    }

    @if (!string.IsNullOrWhiteSpace(Model.Trip.ToDestination))
    {
        <div class="mb-3">
            <label>Til</label>
            <input type="text" class="form-control" value="@Model.Trip.ToDestination" readonly />
        </div>
    }

    <!-- Dato -->
    <div class="mb-3">
        <label asp-for="Trip.TripDate">Dato</label>
        <input asp-for="Trip.TripDate" type="date" class="form-control" min="@DateTime.Today.ToString("yyyy-MM-dd")" />
        <span asp-validation-for="Trip.TripDate" class="text-danger"></span>
    </div>

    <!-- Tidspunkt -->
    <div class="mb-3">
        <label asp-for="Trip.TripTime">Tidspunkt</label>
        <input asp-for="Trip.TripTime" type="time" class="form-control" />
        <span asp-validation-for="Trip.TripTime" class="text-danger"></span>
    </div>

    <!-- Sæder -->
    <div class="mb-3">
        <label asp-for="Trip.TripSeats">Antal passagersæder</label>
        <select asp-for="Trip.TripSeats" class="form-control" asp-items="@(new SelectList(Model.SeatOptions))">
            <option value="">Vælg antal</option>
        </select>
        <span asp-validation-for="Trip.TripSeats" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-primary">Opret tur</button>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
